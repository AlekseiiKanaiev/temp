import React from 'react';
import { Grid, GridColumn } from '@atlaskit/page';
import styled from 'styled-components';
import VulnarabilityBadges from './VulnarabilityBadges';

const BannerWrapper = styled.div`
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
  padding: 10px;
  margin-top: 20px;
`;
const BadgesWrapper = styled.div`
  float: right;
`;

const TextWrapper = styled.p`
  font-family: 'Open Sans';
  font-weight: 700;
  font-style: normal;
  font-size: 18px;
  line-height: 24px;
`;

const AdditionalTextWrapper = styled.p`
  font-family: 'Open Sans';
  font-weight: 700;
  font-style: normal;
  font-size: 13px;
  line-height: 24px;
`;

const getTotal = ({ low, medium, high }) => low + medium + high;

export default function VulnerabilityBanner({
  issueCounts,
  projectId,
  projectLink,
}) {
  const total = getTotal(issueCounts);

  const view = total === 0 ? (
    <></>
  ) : (
    <BannerWrapper>
      <Grid layout="fluid">
        <GridColumn medium={9}>
          <TextWrapper>
            {`Snyk found ${total} vulnerabilities in this ${
              projectId ? 'project' : 'repository'
            }`}
          </TextWrapper>
          {projectId && (
          <AdditionalTextWrapper>
            {
                  'To choose how to fix these vulnerabilities and open a fix pull request, '
                }
            <a
              href={projectLink}
              target="_blank"
              rel="noreferrer"
              style={{ fontWeight: 'bold' }}
            >
              visit Snyk
            </a>
          </AdditionalTextWrapper>
          )}
        </GridColumn>
        <GridColumn medium={3}>
          <BadgesWrapper>
            <VulnarabilityBadges issueCounts={issueCounts} />
          </BadgesWrapper>
        </GridColumn>
      </Grid>
    </BannerWrapper>
  );

  return view;
}
