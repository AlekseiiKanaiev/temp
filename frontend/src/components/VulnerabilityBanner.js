import React from 'react';
import { Grid, GridColumn } from '@atlaskit/page';
import styled from 'styled-components';
import VulnarabilityBadges from './VulnarabilityBadges';

const BannerWrapper = styled.div`
  box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px,
    rgba(9, 30, 66, 0.31) 0px 0px 1px;
  padding: 10px;
  margin-top: 10px;
  width: 840px;
`;
const BadgesWrapper = styled.div`
  float: right;
`;

const TextWrapper = styled.p`
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-weight: 700;
  font-style: normal;
  font-size: 14px;
  line-height: 24px;
`;

const AdditionalTextWrapper = styled.p`
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-weight: 400;
  font-style: normal;
  font-size: 14px;
  line-height: 24px;
`;

const LinkWrapper = styled.a`
  color: rgb(107, 119, 140) !important;
`;

const getTotal = ({ low, medium, high }) => low + medium + high;

export default function VulnerabilityBanner({
  issueCounts,
  projectId,
  projectLink,
}) {
  const total = getTotal(issueCounts);

  const view = total === 0 ? (
    <></>
  ) : (
    <BannerWrapper>
      <Grid layout="fluid">
        <GridColumn medium={8}>
          <TextWrapper>
            {`Snyk found ${total} vulnerabilities in this ${
              projectId ? 'project' : 'repository'
            }`}
          </TextWrapper>
          {projectId && (
          <AdditionalTextWrapper>
            {
                  'To choose how to fix these vulnerabilities and open a fix pull request, '
                }
            <LinkWrapper
              href={projectLink}
              target="_blank"
              rel="noreferrer"
            >
              visit Snyk
            </LinkWrapper>
          </AdditionalTextWrapper>
          )}
        </GridColumn>
        <GridColumn medium={4}>
          <BadgesWrapper>
            <VulnarabilityBadges issueCounts={issueCounts} />
          </BadgesWrapper>
        </GridColumn>
      </Grid>
    </BannerWrapper>
  );

  return view;
}
